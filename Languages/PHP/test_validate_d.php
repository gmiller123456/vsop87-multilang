<?php

//VSOP87-Multilang http://www.astrogreg.com/vsop87-multilang/index.html
//Greg Miller (gmiller@gregmiller.net) 2019.  Released as Public Domain


require("vsop87d_full.php");
require("vsop87d_full_velocities.php");

$passok=1;

function jd2et($jd){
	return ($jd - 2451545.0) / 365250.0;
}

function check2($a,$b){
	$pi=3.14159265358979;

	$t1 = fmod($a,$pi);
	$t2 = fmod($b,$pi);

	if ($t1 < 0){
		$t1 +=$pi;
	}
	if ($t2 < 0){
		$t2 +=$pi;
	}
	if (abs($t1-$t2) > .0000000009){
		print ("Fail:".$t1." - ".$t2." = ".(abs($t1-$t2))."\r\n");
		$passok=0;
	}else{
	}
}

function check6($r,$a,$k,$q,$l,$h,$p){

	check2($r[0],$a);
	check2($r[1],$l);
	check2($r[2],$k);
	check2($r[3],$h);
	check2($r[4],$q);
	check2($r[5],$p);
}

function check3($r,$a,$b,$c){
	check2($r[0], $a);
	check2($r[1], $b);
	check2($r[2], $c);
}

$temp=vsop87d_full::getMercury(jd2et(2451545.0));
check3($temp,4.4293481036,-.0527573409,.4664714751);
$temp=vsop87d_full_velocities::getMercury(jd2et(2451545.0));
check3($temp,.0479095093,-.0053006055,.0003551593);
$temp=vsop87d_full::getMercury(jd2et(2415020.0));
check3($temp,3.4851161911,.0565906173,.4183426275);
$temp=vsop87d_full_velocities::getMercury(jd2et(2415020.0));
check3($temp,.0595923705,-.0064746087,.0048383515);
$temp=vsop87d_full::getMercury(jd2et(2378495.0));
check3($temp,2.0737894888,.1168184804,.3233909533);
$temp=vsop87d_full_velocities::getMercury(jd2et(2378495.0));
check3($temp,.1007745969,.0035976980,.0040779555);
$temp=vsop87d_full::getMercury(jd2et(2341970.0));
check3($temp,.1910149587,-.0682441256,.3381563139);
$temp=vsop87d_full_velocities::getMercury(jd2et(2341970.0));
check3($temp,.0913397621,.0092720130,-.0051301893);
$temp=vsop87d_full::getMercury(jd2et(2305445.0));
check3($temp,5.1836421820,-.1170914848,.4326517759);
$temp=vsop87d_full_velocities::getMercury(jd2et(2305445.0));
check3($temp,.0563078443,-.0019460816,-.0041687376);
$temp=vsop87d_full::getMercury(jd2et(2268920.0));
check3($temp,4.2636517903,-.0457048516,.4661523936);
$temp=vsop87d_full_velocities::getMercury(jd2et(2268920.0));
check3($temp,.0479439034,-.0054474573,.0005305577);
$temp=vsop87d_full::getMercury(jd2et(2232395.0));
check3($temp,3.3115600862,.0639722347,.4152385205);
$temp=vsop87d_full_velocities::getMercury(jd2et(2232395.0));
check3($temp,.0605435516,-.0063076525,.0049542248);
$temp=vsop87d_full::getMercury(jd2et(2195870.0));
check3($temp,1.8738888759,.1126774697,.3209366232);
$temp=vsop87d_full_velocities::getMercury(jd2et(2195870.0));
check3($temp,.1022284345,.0047707226,.0038043935);
$temp=vsop87d_full::getMercury(jd2et(2159345.0));
check3($temp,6.2819826060,-.0768697084,.3414354250);
$temp=vsop87d_full_velocities::getMercury(jd2et(2159345.0));
check3($temp,.0897098220,.0085059878,-.0052737850);
$temp=vsop87d_full::getMercury(jd2et(2122820.0));
check3($temp,5.0128397764,-.1143275808,.4352063237);
$temp=vsop87d_full_velocities::getMercury(jd2et(2122820.0));
check3($temp,.0556152455,-.0023509297,-.0040232429);
$temp=vsop87d_full::getVenus(jd2et(2451545.0));
check3($temp,3.1870221833,.0569782849,.7202129253);
$temp=vsop87d_full_velocities::getVenus(jd2et(2451545.0));
check3($temp,.0282472304,-.0004582174,.0001057609);
$temp=vsop87d_full::getVenus(jd2et(2415020.0));
check3($temp,5.9749622238,-.0591260014,.7274719359);
$temp=vsop87d_full_velocities::getVenus(jd2et(2415020.0));
check3($temp,.0276932290,-.0000981975,-.0000738187);
$temp=vsop87d_full::getVenus(jd2et(2378495.0));
check3($temp,2.5083656668,.0552309407,.7185473298);
$temp=vsop87d_full_velocities::getVenus(jd2et(2378495.0));
check3($temp,.0283727833,.0006052624,.0000357622);
$temp=vsop87d_full::getVenus(jd2et(2341970.0));
check3($temp,5.3115708036,-.0455979904,.7283407528);
$temp=vsop87d_full_velocities::getVenus(jd2et(2341970.0));
check3($temp,.0275882476,-.0010411153,.0000066108);
$temp=vsop87d_full::getVenus(jd2et(2305445.0));
check3($temp,1.8291359617,.0311394084,.7186375037);
$temp=vsop87d_full_velocities::getVenus(jd2et(2305445.0));
check3($temp,.0283070593,.0014252119,-.0000505361);
$temp=vsop87d_full::getVenus(jd2et(2268920.0));
check3($temp,4.6495448744,-.0145437542,.7273363753);
$temp=vsop87d_full_velocities::getVenus(jd2et(2268920.0));
check3($temp,.0276128079,-.0015850133,.0000879530);
$temp=vsop87d_full::getVenus(jd2et(2232395.0));
check3($temp,1.1527504143,-.0054100666,.7205428514);
$temp=vsop87d_full_velocities::getVenus(jd2et(2232395.0));
check3($temp,.0281308261,.0016585927,-.0001198485);
$temp=vsop87d_full::getVenus(jd2et(2195870.0));
check3($temp,3.9850309909,.0222342485,.7247441174);
$temp=vsop87d_full_velocities::getVenus(jd2et(2195870.0));
check3($temp,.0278186029,-.0015253233,.0001384965);
$temp=vsop87d_full::getVenus(jd2et(2159345.0));
check3($temp,.4804699931,-.0395505250,.7235430458);
$temp=vsop87d_full_velocities::getVenus(jd2et(2159345.0));
check3($temp,.0279409153,.0012274064,-.0001442265);
$temp=vsop87d_full::getVenus(jd2et(2122820.0));
check3($temp,3.3145399295,.0505016053,.7215819783);
$temp=vsop87d_full_velocities::getVenus(jd2et(2122820.0));
check3($temp,.0281206788,-.0008621804,.0001373350);
$temp=vsop87d_full::getEarth(jd2et(2451545.0));
check3($temp,1.7519238681,-.0000039656,.9833276819);
$temp=vsop87d_full_velocities::getEarth(jd2et(2451545.0));
check3($temp,.0177924465,.0000001146,-.0000073533);
$temp=vsop87d_full::getEarth(jd2et(2415020.0));
check3($temp,1.7391225563,-.0000005679,.9832689778);
$temp=vsop87d_full_velocities::getEarth(jd2et(2415020.0));
check3($temp,.0177986246,-.0000007021,-.0000063767);
$temp=vsop87d_full::getEarth(jd2et(2378495.0));
check3($temp,1.7262638916,.0000002083,.9832274321);
$temp=vsop87d_full_velocities::getEarth(jd2et(2378495.0));
check3($temp,.0177977841,-.0000002336,-.0000080498);
$temp=vsop87d_full::getEarth(jd2et(2341970.0));
check3($temp,1.7134419105,.0000025051,.9831498441);
$temp=vsop87d_full_velocities::getEarth(jd2et(2341970.0));
check3($temp,.0177946240,.0000005708,-.0000047389);
$temp=vsop87d_full::getEarth(jd2et(2305445.0));
check3($temp,1.7006065938,-.0000016359,.9831254376);
$temp=vsop87d_full_velocities::getEarth(jd2et(2305445.0));
check3($temp,.0177887700,.0000004115,.0000033440);
$temp=vsop87d_full::getEarth(jd2et(2268920.0));
check3($temp,1.6877624960,-.0000020340,.9830816756);
$temp=vsop87d_full_velocities::getEarth(jd2et(2268920.0));
check3($temp,.0177901891,-.0000004781,.0000136071);
$temp=vsop87d_full::getEarth(jd2et(2232395.0));
check3($temp,1.6750110961,.0000037879,.9830754409);
$temp=vsop87d_full_velocities::getEarth(jd2et(2232395.0));
check3($temp,.0177958136,-.0000005221,.0000242192);
$temp=vsop87d_full::getEarth(jd2et(2195870.0));
check3($temp,1.6622048657,.0000015133,.9830942385);
$temp=vsop87d_full_velocities::getEarth(jd2et(2195870.0));
check3($temp,.0178015076,.0000002953,.0000271498);
$temp=vsop87d_full::getEarth(jd2et(2159345.0));
check3($temp,1.6495143197,-.0000013003,.9830440397);
$temp=vsop87d_full_velocities::getEarth(jd2et(2159345.0));
check3($temp,.0178071396,.0000006915,.0000275960);
$temp=vsop87d_full::getEarth(jd2et(2122820.0));
check3($temp,1.6367193623,-.0000031292,.9830331815);
$temp=vsop87d_full_velocities::getEarth(jd2et(2122820.0));
check3($temp,.0178036194,-.0000001563,.0000273747);
$temp=vsop87d_full::getMars(jd2et(2451545.0));
check3($temp,6.2735389983,-.0247779824,1.3912076925);
$temp=vsop87d_full_velocities::getMars(jd2et(2451545.0));
check3($temp,.0109247619,.0002261122,.0005173281);
$temp=vsop87d_full::getMars(jd2et(2415020.0));
check3($temp,4.9942005211,-.0271965869,1.4218777705);
$temp=vsop87d_full_velocities::getMars(jd2et(2415020.0));
check3($temp,.0104598895,-.0001821239,-.0009706919);
$temp=vsop87d_full::getMars(jd2et(2378495.0));
check3($temp,3.8711855478,.0034969939,1.5615140011);
$temp=vsop87d_full_velocities::getMars(jd2et(2378495.0));
check3($temp,.0086666187,-.0002784034,-.0012229676);
$temp=vsop87d_full::getMars(jd2et(2341970.0));
check3($temp,2.9166648690,.0280268149,1.6584697082);
$temp=vsop87d_full_velocities::getMars(jd2et(2341970.0));
check3($temp,.0076889546,-.0001236824,-.0003706795);
$temp=vsop87d_full::getMars(jd2et(2305445.0));
check3($temp,2.0058210394,.0300702181,1.6371997207);
$temp=vsop87d_full_velocities::getMars(jd2et(2305445.0));
check3($temp,.0078914116,.0000936274,.0007230990);
$temp=vsop87d_full::getMars(jd2et(2268920.0));
check3($temp,1.0050966939,.0066676098,1.5123622690);
$temp=vsop87d_full_velocities::getMars(jd2et(2268920.0));
check3($temp,.0092394655,.0002924831,.0013005711);
$temp=vsop87d_full::getMars(jd2et(2232395.0));
check3($temp,6.0979760762,-.0266794243,1.3925964529);
$temp=vsop87d_full_velocities::getMars(jd2et(2232395.0));
check3($temp,.0109044950,.0001995751,.0005353359);
$temp=vsop87d_full::getMars(jd2et(2195870.0));
check3($temp,4.8193924948,-.0255031923,1.4208707215);
$temp=vsop87d_full_velocities::getMars(jd2et(2195870.0));
check3($temp,.0104742113,-.0002087747,-.0009489904);
$temp=vsop87d_full::getMars(jd2et(2159345.0));
check3($temp,3.6939294875,.0065885509,1.5593802008);
$temp=vsop87d_full_velocities::getMars(jd2et(2159345.0));
check3($temp,.0086913497,-.0002756376,-.0012209924);
$temp=vsop87d_full::getMars(jd2et(2122820.0));
check3($temp,2.7367104344,.0295522719,1.6571002307);
$temp=vsop87d_full_velocities::getMars(jd2et(2122820.0));
check3($temp,.0077025917,-.0001021869,-.0003860080);
$temp=vsop87d_full::getJupiter(jd2et(2451545.0));
check3($temp,.6334614186,-.0205001039,4.9653813154);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2451545.0));
check3($temp,.0015914696,.0000157673,.0001304080);
$temp=vsop87d_full::getJupiter(jd2et(2415020.0));
check3($temp,4.0927527024,.0161446618,5.3850276671);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2415020.0));
check3($temp,.0013527902,-.0000218840,-.0002468357);
$temp=vsop87d_full::getJupiter(jd2et(2378495.0));
check3($temp,1.5255696771,-.0043606936,5.1318457604);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2378495.0));
check3($temp,.0014891769,.0000335365,.0003513970);
$temp=vsop87d_full::getJupiter(jd2et(2341970.0));
check3($temp,4.8888943125,-.0011098085,5.1888133656);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2341970.0));
check3($temp,.0014564559,-.0000335011,-.0003701137);
$temp=vsop87d_full::getJupiter(jd2et(2305445.0));
check3($temp,2.3348832684,.0140523907,5.3439455032);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2305445.0));
check3($temp,.0013734853,.0000252124,.0002899715);
$temp=vsop87d_full::getJupiter(jd2et(2268920.0));
check3($temp,5.7527666852,-.0188346311,5.0018007395);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2268920.0));
check3($temp,.0015680371,-.0000212635,-.0002114848);
$temp=vsop87d_full::getJupiter(jd2et(2232395.0));
check3($temp,3.0889515350,.0231157947,5.4491570191);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2232395.0));
check3($temp,.0013213990,.0000039589,.0000468252);
$temp=vsop87d_full::getJupiter(jd2et(2195870.0));
check3($temp,.3776503430,-.0222448936,4.9715071036);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2195870.0));
check3($temp,.0015874932,.0000116588,.0001158213);
$temp=vsop87d_full::getJupiter(jd2et(2159345.0));
check3($temp,3.8455069137,.0185554473,5.3896206945);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2159345.0));
check3($temp,.0013506892,-.0000195538,-.0002148837);
$temp=vsop87d_full::getJupiter(jd2et(2122820.0));
check3($temp,1.2695066546,-.0075335740,5.1193587362);
$temp=vsop87d_full_velocities::getJupiter(jd2et(2122820.0));
check3($temp,.0014965116,.0000335173,.0003415381);
$temp=vsop87d_full::getSaturn(jd2et(2451545.0));
check3($temp,.7980038761,-.0401984149,9.1838483715);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2451545.0));
check3($temp,.0006315388,.0000102810,-.0002152910);
$temp=vsop87d_full::getSaturn(jd2et(2415020.0));
check3($temp,4.6512836347,.0192701409,10.0668531997);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2415020.0));
check3($temp,.0005251308,-.0000204421,.0000314346);
$temp=vsop87d_full::getSaturn(jd2et(2378495.0));
check3($temp,2.1956677359,.0104156566,9.1043068639);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2378495.0));
check3($temp,.0006415768,.0000271252,.0001888842);
$temp=vsop87d_full::getSaturn(jd2et(2341970.0));
check3($temp,5.8113963637,-.0291472787,9.7629994924);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2341970.0));
check3($temp,.0005584480,-.0000181139,-.0002760239);
$temp=vsop87d_full::getSaturn(jd2et(2305445.0));
check3($temp,3.5217555199,.0437035058,9.7571035629);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2305445.0));
check3($temp,.0005594038,-.0000006983,.0002970345);
$temp=vsop87d_full::getSaturn(jd2et(2268920.0));
check3($temp,.8594235308,-.0379350088,9.0669212839);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2268920.0));
check3($temp,.0006470969,.0000141612,-.0001756487);
$temp=vsop87d_full::getSaturn(jd2et(2232395.0));
check3($temp,4.6913199264,.0146771898,10.1065692994);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2232395.0));
check3($temp,.0005201683,-.0000214885,-.0000400552);
$temp=vsop87d_full::getSaturn(jd2et(2195870.0));
check3($temp,2.2948875823,.0178533697,9.1857599537);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2195870.0));
check3($temp,.0006290832,.0000251980,.0002663743);
$temp=vsop87d_full::getSaturn(jd2et(2159345.0));
check3($temp,5.8660241564,-.0333866503,9.5927173940);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2159345.0));
check3($temp,.0005771902,-.0000164313,-.0003120077);
$temp=vsop87d_full::getSaturn(jd2et(2122820.0));
check3($temp,3.5570108069,.0435371139,9.8669939498);
$temp=vsop87d_full_velocities::getSaturn(jd2et(2122820.0));
check3($temp,.0005458233,-.0000033630,.0002502429);
$temp=vsop87d_full::getUranus(jd2et(2451545.0));
check3($temp,5.5225485803,-.0119527838,19.9240482667);
$temp=vsop87d_full_velocities::getUranus(jd2et(2451545.0));
check3($temp,.0001905185,-.0000011886,.0000977914);
$temp=vsop87d_full::getUranus(jd2et(2415020.0));
check3($temp,4.3397761173,.0011570307,18.9927163620);
$temp=vsop87d_full_velocities::getUranus(jd2et(2415020.0));
check3($temp,.0002099770,-.0000028204,.0001832534);
$temp=vsop87d_full::getUranus(jd2et(2378495.0));
check3($temp,3.0388348558,.0132392955,18.2991154397);
$temp=vsop87d_full_velocities::getUranus(jd2et(2378495.0));
check3($temp,.0002257402,-.0000005801,.0000296138);
$temp=vsop87d_full::getUranus(jd2et(2341970.0));
check3($temp,1.7242204720,.0059836565,18.7966208854);
$temp=vsop87d_full_velocities::getUranus(jd2et(2341970.0));
check3($temp,.0002133550,.0000025663,-.0001670846);
$temp=vsop87d_full::getUranus(jd2et(2305445.0));
check3($temp,.5223325214,-.0089983885,19.7819882707);
$temp=vsop87d_full_velocities::getUranus(jd2et(2305445.0));
check3($temp,.0001929802,.0000019325,-.0001352303);
$temp=vsop87d_full::getUranus(jd2et(2268920.0));
check3($temp,5.6817615582,-.0129257254,20.0300462993);
$temp=vsop87d_full_velocities::getUranus(jd2et(2268920.0));
check3($temp,.0001888747,-.0000006990,.0000528369);
$temp=vsop87d_full::getUranus(jd2et(2232395.0));
check3($temp,4.5254482963,-.0019303340,19.2694311058);
$temp=vsop87d_full_velocities::getUranus(jd2et(2232395.0));
check3($temp,.0002036904,-.0000027058,.0001837904);
$temp=vsop87d_full::getUranus(jd2et(2195870.0));
check3($temp,3.2557221720,.0120919639,18.3948228639);
$temp=vsop87d_full_velocities::getUranus(jd2et(2195870.0));
check3($temp,.0002229616,-.0000013148,.0000816221);
$temp=vsop87d_full::getUranus(jd2et(2159345.0));
check3($temp,1.9333853935,.0088045918,18.5841501334);
$temp=vsop87d_full_velocities::getUranus(jd2et(2159345.0));
check3($temp,.0002185738,.0000022193,-.0001379361);
$temp=vsop87d_full::getUranus(jd2et(2122820.0));
check3($temp,.7007226224,-.0065610611,19.5612078271);
$temp=vsop87d_full_velocities::getUranus(jd2et(2122820.0));
check3($temp,.0001978055,.0000023223,-.0001607791);
$temp=vsop87d_full::getNeptune(jd2et(2451545.0));
check3($temp,5.3045629252,.0042236789,30.1205328392);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2451545.0));
check3($temp,.0001046473,-.0000031841,-.0000351213);
$temp=vsop87d_full::getNeptune(jd2et(2415020.0));
check3($temp,1.4956195225,-.0219610030,29.8710345051);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2415020.0));
check3($temp,.0001061710,.0000023201,.0000148205);
$temp=vsop87d_full::getNeptune(jd2et(2378495.0));
check3($temp,3.9290537977,.0310692112,30.3209192288);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2378495.0));
check3($temp,.0001031840,-.0000003128,.0000052319);
$temp=vsop87d_full::getNeptune(jd2et(2341970.0));
check3($temp,.0815199679,-.0260752533,29.8685860491);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2341970.0));
check3($temp,.0001065815,-.0000018460,-.0000089715);
$temp=vsop87d_full::getNeptune(jd2et(2305445.0));
check3($temp,2.5537079778,.0102374010,30.1360158724);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2305445.0));
check3($temp,.0001048359,.0000031071,.0000264309);
$temp=vsop87d_full::getNeptune(jd2et(2268920.0));
check3($temp,4.9678695785,.0116907777,30.1785350169);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2268920.0));
check3($temp,.0001044173,-.0000030582,-.0000303637);
$temp=vsop87d_full::getNeptune(jd2et(2232395.0));
check3($temp,1.1523661584,-.0273547725,29.8326055236);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2232395.0));
check3($temp,.0001065954,.0000017305,.0000063316);
$temp=vsop87d_full::getNeptune(jd2et(2195870.0));
check3($temp,3.5930943433,.0316878975,30.3109114960);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2195870.0));
check3($temp,.0001032055,.0000004694,.0000068902);
$temp=vsop87d_full::getNeptune(jd2et(2159345.0));
check3($temp,6.0203596580,-.0215169842,29.9065506848);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2159345.0));
check3($temp,.0001061056,-.0000025258,-.0000157107);
$temp=vsop87d_full::getNeptune(jd2et(2122820.0));
check3($temp,2.2124988267,.0027498093,30.0653693610);
$temp=vsop87d_full_velocities::getNeptune(jd2et(2122820.0));
check3($temp,.0001051888,.0000033730,.0000314401);

print("Pass:");
print($passok);
?>
