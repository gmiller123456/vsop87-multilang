<?php

//VSOP87-Multilang http://www.celestialprogramming.com/vsop87-multilang/index.html
//Greg Miller (gmiller@gregmiller.net) 2019.  Released as Public Domain


require("vsop87b_full.php");
require("vsop87b_full_velocities.php");

$passok=1;

function jd2et($jd){
	return ($jd - 2451545.0) / 365250.0;
}

function check2($a,$b){
	$pi=3.14159265358979;

	$t1 = fmod($a,$pi);
	$t2 = fmod($b,$pi);

	if ($t1 < 0){
		$t1 +=$pi;
	}
	if ($t2 < 0){
		$t2 +=$pi;
	}
	if (abs($t1-$t2) > .0000000009){
		print ("Fail:".$t1." - ".$t2." = ".(abs($t1-$t2))."\r\n");
		$passok=0;
	}else{
	}
}

function check6($r,$a,$k,$q,$l,$h,$p){

	check2($r[0],$a);
	check2($r[1],$l);
	check2($r[2],$k);
	check2($r[3],$h);
	check2($r[4],$q);
	check2($r[5],$p);
}

function check3($r,$a,$b,$c){
	check2($r[0], $a);
	check2($r[1], $b);
	check2($r[2], $c);
}

$temp=vsop87b_full::getMercury(jd2et(2451545.0));
check3($temp,4.4293481043,-.0527573411,.4664714751);
$temp=vsop87b_full_velocities::getMercury(jd2et(2451545.0));
check3($temp,.0479088415,-.0053005994,.0003551593);
$temp=vsop87b_full::getMercury(jd2et(2415020.0));
check3($temp,3.5095041512,.0564907883,.4183426276);
$temp=vsop87b_full_velocities::getMercury(jd2et(2415020.0));
check3($temp,.0595900338,-.0064868219,.0048383515);
$temp=vsop87b_full::getMercury(jd2et(2378495.0));
check3($temp,2.1225631484,.1171864614,.3233909531);
$temp=vsop87b_full_velocities::getMercury(jd2et(2378495.0));
check3($temp,.1007792689,.0035704944,.0040779555);
$temp=vsop87b_full::getMercury(jd2et(2341970.0));
check3($temp,.2641557554,-.0680150537,.3381563139);
$temp=vsop87b_full_velocities::getMercury(jd2et(2341970.0));
check3($temp,.0913316347,.0093309731,-.0051301892);
$temp=vsop87b_full::getMercury(jd2et(2305445.0));
check3($temp,5.2811474961,-.1178238226,.4326517759);
$temp=vsop87b_full_velocities::getMercury(jd2et(2305445.0));
check3($temp,.0563131138,-.0019152855,-.0041687376);
$temp=vsop87b_full::getMercury(jd2et(2268920.0));
check3($temp,4.3854123464,-.0468100865,.4661523937);
$temp=vsop87b_full_velocities::getMercury(jd2et(2268920.0));
check3($temp,.0479440925,-.0054614651,.0005305578);
$temp=vsop87b_full::getMercury(jd2et(2232395.0));
check3($temp,3.4577380614,.0634626330,.4152385207);
$temp=vsop87b_full_velocities::getMercury(jd2et(2232395.0));
check3($temp,.0605327941,-.0063848195,.0049542248);
$temp=vsop87b_full::getMercury(jd2et(2195870.0));
check3($temp,2.0443901595,.1140574170,.3209366231);
$temp=vsop87b_full_velocities::getMercury(jd2et(2195870.0));
check3($temp,.1022477370,.0046873828,.0038043935);
$temp=vsop87b_full::getMercury(jd2et(2159345.0));
check3($temp,.1936433214,-.0764174092,.3414354247);
$temp=vsop87b_full_velocities::getMercury(jd2et(2159345.0));
check3($temp,.0896907013,.0086653116,-.0052737850);
$temp=vsop87b_full::getMercury(jd2et(2122820.0));
check3($temp,5.2319689071,-.1160635432,.4352063235);
$temp=vsop87b_full_velocities::getMercury(jd2et(2122820.0));
check3($temp,.0556283750,-.0022888893,-.0040232429);
$temp=vsop87b_full::getVenus(jd2et(2451545.0));
check3($temp,3.1870221910,.0569782849,.7202129248);
$temp=vsop87b_full_velocities::getVenus(jd2et(2451545.0));
check3($temp,.0282465624,-.0004582166,.0001057610);
$temp=vsop87b_full::getVenus(jd2et(2415020.0));
check3($temp,5.9993518124,-.0591709804,.7274719352);
$temp=vsop87b_full_velocities::getVenus(jd2et(2415020.0));
check3($temp,.0276926561,-.0000920061,-.0000738187);
$temp=vsop87b_full::getVenus(jd2et(2378495.0));
check3($temp,2.5571297503,.0554510891,.7185473293);
$temp=vsop87b_full_velocities::getVenus(jd2et(2378495.0));
check3($temp,.0283727025,.0005939180,.0000357621);
$temp=vsop87b_full::getVenus(jd2et(2341970.0));
check3($temp,5.3846889524,-.0460995953,.7283407523);
$temp=vsop87b_full_velocities::getVenus(jd2et(2341970.0));
check3($temp,.0275886984,-.0010282411,.0000066109);
$temp=vsop87b_full::getVenus(jd2et(2305445.0));
check3($temp,1.9265887457,.0319707652,.7186375045);
$temp=vsop87b_full_velocities::getVenus(jd2et(2305445.0));
check3($temp,.0283076752,.0014144582,-.0000505361);
$temp=vsop87b_full::getVenus(jd2et(2268920.0));
check3($temp,4.7713211615,-.0156777292,.7273363751);
$temp=vsop87b_full_velocities::getVenus(jd2et(2268920.0));
check3($temp,.0276128445,-.0015809976,.0000879530);
$temp=vsop87b_full::getVenus(jd2et(2232395.0));
check3($temp,1.2988483958,-.0040667685,.7205428515);
$temp=vsop87b_full_velocities::getVenus(jd2et(2232395.0));
check3($temp,.0281295103,.0016665514,-.0001198485);
$temp=vsop87b_full::getVenus(jd2et(2195870.0));
check3($temp,4.1554559280,.0208254122,.7247441174);
$temp=vsop87b_full_velocities::getVenus(jd2et(2195870.0));
check3($temp,.0278159202,-.0015465723,.0001384965);
$temp=vsop87b_full::getVenus(jd2et(2159345.0));
check3($temp,.6752327774,-.0383268978,.7235430454);
$temp=vsop87b_full_velocities::getVenus(jd2et(2159345.0));
check3($temp,.0279372139,.0012655282,-.0001442266);
$temp=vsop87b_full::getVenus(jd2et(2122820.0));
check3($temp,3.5336333775,.0496161272,.7215819773);
$temp=vsop87b_full_velocities::getVenus(jd2et(2122820.0));
check3($temp,.0281171067,-.0009145826,.0001373349);
$temp=vsop87b_full::getEarth(jd2et(2451545.0));
check3($temp,1.7519238637,-.0000039656,.9833276823);
$temp=vsop87b_full_velocities::getEarth(jd2et(2451545.0));
check3($temp,.0177917776,.0000001086,-.0000073533);
$temp=vsop87b_full::getEarth(jd2et(2415020.0));
check3($temp,1.7634989198,.0002186910,.9832689762);
$temp=vsop87b_full_velocities::getEarth(jd2et(2415020.0));
check3($temp,.0177979584,-.0000018217,-.0000063768);
$temp=vsop87b_full::getEarth(jd2et(2378495.0));
check3($temp,1.7750058558,.0004381095,.9832274335);
$temp=vsop87b_full_velocities::getEarth(jd2et(2378495.0));
check3($temp,.0177971184,-.0000025252,-.0000080500);
$temp=vsop87b_full::getEarth(jd2et(2341970.0));
check3($temp,1.7865387214,.0006583865,.9831498445);
$temp=vsop87b_full_velocities::getEarth(jd2et(2341970.0));
check3($temp,.0177939610,-.0000029509,-.0000047388);
$temp=vsop87b_full::getEarth(jd2et(2305445.0));
check3($temp,1.7980474965,.0008715329,.9831254370);
$temp=vsop87b_full_velocities::getEarth(jd2et(2305445.0));
check3($temp,.0177881098,-.0000043973,.0000033439);
$temp=vsop87b_full::getEarth(jd2et(2268920.0));
check3($temp,1.8095367659,.0010876906,.9830816762);
$temp=vsop87b_full_velocities::getEarth(jd2et(2268920.0));
check3($temp,.0177895327,-.0000066333,.0000136071);
$temp=vsop87b_full::getEarth(jd2et(2232395.0));
check3($temp,1.8211080285,.0013092603,.9830754398);
$temp=vsop87b_full_velocities::getEarth(jd2et(2232395.0));
check3($temp,.0177951614,-.0000080856,.0000242193);
$temp=vsop87b_full::getEarth(jd2et(2195870.0));
check3($temp,1.8326137391,.0015219401,.9830942391);
$temp=vsop87b_full_velocities::getEarth(jd2et(2195870.0));
check3($temp,.0178008613,-.0000087341,.0000271497);
$temp=vsop87b_full::getEarth(jd2et(2159345.0));
check3($temp,1.8442244563,.0017331615,.9830440401);
$temp=vsop87b_full_velocities::getEarth(jd2et(2159345.0));
check3($temp,.0178064995,-.0000098656,.0000275959);
$temp=vsop87b_full::getEarth(jd2et(2122820.0));
check3($temp,1.8557201152,.0019445314,.9830331809);
$temp=vsop87b_full_velocities::getEarth(jd2et(2122820.0));
check3($temp,.0178029841,-.0000122904,.0000273745);
$temp=vsop87b_full::getMars(jd2et(2451545.0));
check3($temp,6.2735389872,-.0247779824,1.3912076937);
$temp=vsop87b_full_velocities::getMars(jd2et(2451545.0));
check3($temp,.0109240945,.0002261117,.0005173279);
$temp=vsop87b_full::getMars(jd2et(2415020.0));
check3($temp,5.0185792656,-.0274073500,1.4218777718);
$temp=vsop87b_full_velocities::getMars(jd2et(2415020.0));
check3($temp,.0104592980,-.0001812082,-.0009706918);
$temp=vsop87b_full::getMars(jd2et(2378495.0));
check3($temp,3.9199284825,.0031513365,1.5615140022);
$temp=vsop87b_full_velocities::getMars(jd2et(2378495.0));
check3($temp,.0086658589,-.0002809807,-.0012229676);
$temp=vsop87b_full::getMars(jd2et(2341970.0));
check3($temp,2.9897807830,.0280781217,1.6584697094);
$temp=vsop87b_full_velocities::getMars(jd2et(2341970.0));
check3($temp,.0076882128,-.0001289346,-.0003706796);
$temp=vsop87b_full::getMars(jd2et(2305445.0));
check3($temp,2.1032776583,.0308218939,1.6371997174);
$temp=vsop87b_full_velocities::getMars(jd2et(2305445.0));
check3($temp,.0078909734,.0000895197,.0007230990);
$temp=vsop87b_full::getMars(jd2et(2268920.0));
check3($temp,1.1268677424,.0077311848,1.5123622675);
$temp=vsop87b_full_velocities::getMars(jd2et(2268920.0));
check3($temp,.0092387474,.0002963509,.0013005711);
$temp=vsop87b_full::getMars(jd2et(2232395.0));
check3($temp,6.2441093266,-.0266449540,1.3925964455);
$temp=vsop87b_full_velocities::getMars(jd2et(2232395.0));
check3($temp,.0109035346,.0002145391,.0005353358);
$temp=vsop87b_full::getMars(jd2et(2195870.0));
check3($temp,4.9898149167,-.0270155266,1.4208707148);
$temp=vsop87b_full_velocities::getMars(jd2et(2195870.0));
check3($temp,.0104740710,-.0002032117,-.0009489905);
$temp=vsop87b_full::getMars(jd2et(2159345.0));
check3($temp,3.8886466318,.0052701267,1.5593802043);
$temp=vsop87b_full_velocities::getMars(jd2et(2159345.0));
check3($temp,.0086902591,-.0002866986,-.0012209923);
$temp=vsop87b_full::getMars(jd2et(2122820.0));
check3($temp,2.9557712523,.0298285524,1.6571002362);
$temp=vsop87b_full_velocities::getMars(jd2et(2122820.0));
check3($temp,.0077017638,-.0001179366,-.0003860081);
$temp=vsop87b_full::getJupiter(jd2et(2451545.0));
check3($temp,.6334614217,-.0205001039,4.9653812803);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2451545.0));
check3($temp,.0015908021,.0000157632,.0001304081);
$temp=vsop87b_full::getJupiter(jd2et(2415020.0));
check3($temp,4.1171308454,.0159456650,5.3850276351);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2415020.0));
check3($temp,.0013521165,-.0000220291,-.0002468356);
$temp=vsop87b_full::getJupiter(jd2et(2378495.0));
check3($temp,1.5743114744,-.0039059814,5.1318457347);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2378495.0));
check3($temp,.0014885082,.0000334729,.0003513969);
$temp=vsop87b_full::getJupiter(jd2et(2341970.0));
check3($temp,4.9619913552,-.0017586234,5.1888133706);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2341970.0));
check3($temp,.0014557981,-.0000331754,-.0003701135);
$temp=vsop87b_full::getJupiter(jd2et(2305445.0));
check3($temp,2.4323346134,.0145957282,5.3439455250);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2305445.0));
check3($temp,.0013728479,.0000241997,.0002899716);
$temp=vsop87b_full::getJupiter(jd2et(2268920.0));
check3($temp,5.8745612668,-.0192161117,5.0018007431);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2268920.0));
check3($temp,.0015674041,-.0000195721,-.0002114846);
$temp=vsop87b_full::getJupiter(jd2et(2232395.0));
check3($temp,3.2350793731,.0229002244,5.4491570418);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2232395.0));
check3($temp,.0013207309,.0000021691,.0000468249);
$temp=vsop87b_full::getJupiter(jd2et(2195870.0));
check3($temp,.5480874612,-.0213293086,4.9715070844);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2195870.0));
check3($temp,.0015867790,.0000137427,.0001158214);
$temp=vsop87b_full::getJupiter(jd2et(2159345.0));
check3($temp,4.0402354041,.0170598705,5.3896207448);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2159345.0));
check3($temp,.0013499666,-.0000209792,-.0002148837);
$temp=vsop87b_full::getJupiter(jd2et(2122820.0));
check3($temp,1.4885071580,-.0054711800,5.1193587263);
$temp=vsop87b_full_velocities::getJupiter(jd2et(2122820.0));
check3($temp,.0014958247,.0000336059,.0003415379);
$temp=vsop87b_full::getSaturn(jd2et(2451545.0));
check3($temp,.7980038867,-.0401984149,9.1838482881);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2451545.0));
check3($temp,.0006308712,.0000102761,-.0002152906);
$temp=vsop87b_full::getSaturn(jd2et(2415020.0));
check3($temp,4.6756597986,.0190423976,10.0668532372);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2415020.0));
check3($temp,.0005244615,-.0000204301,.0000314349);
$temp=vsop87b_full::getSaturn(jd2et(2378495.0));
check3($temp,2.2444130058,.0107481008,9.1043067563);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2378495.0));
check3($temp,.0006409199,.0000269202,.0001888843);
$temp=vsop87b_full::getSaturn(jd2et(2341970.0));
check3($temp,5.8845121485,-.0293639468,9.7629995093);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2341970.0));
check3($temp,.0005577958,-.0000177494,-.0002760244);
$temp=vsop87b_full::getSaturn(jd2et(2305445.0));
check3($temp,3.6192301828,.0432255907,9.7571035121);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2305445.0));
check3($temp,.0005587245,-.0000011304,.0002970342);
$temp=vsop87b_full::getSaturn(jd2et(2268920.0));
check3($temp,.9812189105,-.0369435533,9.0669213668);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2268920.0));
check3($temp,.0006463981,.0000145238,-.0001756484);
$temp=vsop87b_full::getSaturn(jd2et(2232395.0));
check3($temp,4.8374129245,.0133288784,10.1065693352);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2232395.0));
check3($temp,.0005194981,-.0000213482,-.0000400555);
$temp=vsop87b_full::getSaturn(jd2et(2195870.0));
check3($temp,2.4653200325,.0187797598,9.1857599387);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2195870.0));
check3($temp,.0006284607,.0000243723,.0002663746);
$temp=vsop87b_full::getSaturn(jd2et(2159345.0));
check3($temp,6.0607944160,-.0336906976,9.5927174218);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2159345.0));
check3($temp,.0005765590,-.0000153880,-.0003120082);
$temp=vsop87b_full::getSaturn(jd2et(2122820.0));
check3($temp,3.7760794190,.0422300831,9.8669939127);
$temp=vsop87b_full_velocities::getSaturn(jd2et(2122820.0));
check3($temp,.0005451205,-.0000042296,.0002502430);
$temp=vsop87b_full::getUranus(jd2et(2451545.0));
check3($temp,5.5225485297,-.0119527878,19.9240478952);
$temp=vsop87b_full_velocities::getUranus(jd2et(2451545.0));
check3($temp,.0001898515,-.0000011847,.0000977923);
$temp=vsop87b_full::getUranus(jd2et(2415020.0));
check3($temp,4.3641525628,.0009368610,18.9927163179);
$temp=vsop87b_full_velocities::getUranus(jd2et(2415020.0));
check3($temp,.0002093098,-.0000028267,.0001832551);
$temp=vsop87b_full::getUranus(jd2et(2378495.0));
check3($temp,3.0875827851,.0132269524,18.2991151619);
$temp=vsop87b_full_velocities::getUranus(jd2et(2378495.0));
check3($temp,.0002250721,-.0000006827,.0000296121);
$temp=vsop87b_full::getUranus(jd2et(2341970.0));
check3($temp,1.7973185850,.0066373711,18.7966207283);
$temp=vsop87b_full_velocities::getUranus(jd2et(2341970.0));
check3($temp,.0002126898,.0000025168,-.0001670813);
$temp=vsop87b_full::getUranus(jd2et(2305445.0));
check3($temp,.6197794565,-.0084149193,19.7819885654);
$temp=vsop87b_full_velocities::getUranus(jd2et(2305445.0));
check3($temp,.0001923118,.0000020639,-.0001352235);
$temp=vsop87b_full::getUranus(jd2et(2268920.0));
check3($temp,5.8035494552,-.0133827060,20.0300461334);
$temp=vsop87b_full_velocities::getUranus(jd2et(2268920.0));
check3($temp,.0001882102,-.0000004992,.0000528354);
$temp=vsop87b_full::getUranus(jd2et(2232395.0));
check3($temp,4.6715450662,-.0033027749,19.2694312936);
$temp=vsop87b_full_velocities::getUranus(jd2et(2232395.0));
check3($temp,.0002030253,-.0000026930,.0001837895);
$temp=vsop87b_full::getUranus(jd2et(2195870.0));
check3($temp,3.4261485604,.0115506263,18.3948232424);
$temp=vsop87b_full_velocities::getUranus(jd2et(2195870.0));
check3($temp,.0002222920,-.0000016482,.0000816210);
$temp=vsop87b_full::getUranus(jd2et(2159345.0));
check3($temp,2.1281050050,.0103036775,18.5841497556);
$temp=vsop87b_full_velocities::getUranus(jd2et(2159345.0));
check3($temp,.0002179147,.0000019842,-.0001379326);
$temp=vsop87b_full::getUranus(jd2et(2122820.0));
check3($temp,.9197293285,-.0048575382,19.5612080219);
$temp=vsop87b_full_velocities::getUranus(jd2et(2122820.0));
check3($temp,.0001971364,.0000025467,-.0001607754);
$temp=vsop87b_full::getNeptune(jd2et(2451545.0));
check3($temp,5.3045629284,.0042236790,30.1205329332);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2451545.0));
check3($temp,.0001039797,-.0000031792,-.0000351218);
$temp=vsop87b_full::getNeptune(jd2et(2415020.0));
check3($temp,1.5199957208,-.0217331273,29.8710344515);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2415020.0));
check3($temp,.0001055032,.0000023130,.0000148203);
$temp=vsop87b_full::getNeptune(jd2et(2378495.0));
check3($temp,3.9778043127,.0307068993,30.3209191027);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2378495.0));
check3($temp,.0001025157,-.0000003363,.0000052324);
$temp=vsop87b_full::getNeptune(jd2et(2341970.0));
check3($temp,.1546340455,-.0259181077,29.8685861463);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2341970.0));
check3($temp,.0001059155,-.0000017767,-.0000089713);
$temp=vsop87b_full::getNeptune(jd2et(2305445.0));
check3($temp,2.6511574700,.0106082425,30.1360158860);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2305445.0));
check3($temp,.0001041725,.0000030174,.0000264306);
$temp=vsop87b_full::getNeptune(jd2et(2268920.0));
check3($temp,5.0896381605,.0106592138,30.1785349992);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2268920.0));
check3($temp,.0001037517,-.0000030013,-.0000303641);
$temp=vsop87b_full::getNeptune(jd2et(2232395.0));
check3($temp,1.2984703832,-.0260115821,29.8326055361);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2232395.0));
check3($temp,.0001059252,.0000017545,.0000063316);
$temp=vsop87b_full::getNeptune(jd2et(2195870.0));
check3($temp,3.7635416328,.0306777430,30.3109115122);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2195870.0));
check3($temp,.0001025371,.0000003456,.0000068907);
$temp=vsop87b_full::getNeptune(jd2et(2159345.0));
check3($temp,6.2151087391,-.0215395777,29.9065506899);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2159345.0));
check3($temp,.0001054447,-.0000023323,-.0000157106);
$temp=vsop87b_full::getNeptune(jd2et(2122820.0));
check3($temp,2.4315044302,.0040125142,30.0653694889);
$temp=vsop87b_full_velocities::getNeptune(jd2et(2122820.0));
check3($temp,.0001045297,.0000031984,.0000314397);


print("Pass:");
print($passok);
?>
